(this["webpackJsonptrading-pit"]=this["webpackJsonptrading-pit"]||[]).push([[0],{329:function(e,t,a){},330:function(e,t,a){},331:function(e,t,a){},431:function(e,t,a){},432:function(e,t,a){},447:function(e,t,a){},448:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(87),s=a.n(i),c=(a(329),a(274)),l=a(307),o=a(45),d=a(199),u=(a(330),a(331),a(465)),h=a(463),j=a(260),b=a.n(j),p=a(123),f=a.n(p),g=a(312),m=a.n(g),x=(a(350),a(351),a(461)),O=a(467),v=a(39),y=a(163),w=(a(94),a(205)),C=a(17);function k(e){var t=e.lookup,a=e.form,n=e.hasGraph,r=x.a.RangePicker;return n?"":Object(C.jsx)("div",{style:{width:"90%",marginTop:"10%"},children:Object(C.jsxs)(u.a,{name:"lookup",autoComplete:"off",form:a,children:[Object(C.jsx)(u.a.Item,{id:"code",name:"stock_code",rules:[{required:!0}],style:{marginBottom:"1vw"},children:Object(C.jsx)(O.a,{placeholder:"\u80a1\u7968\u4ee3\u7801"})}),Object(C.jsx)(v.a,{locale:m.a,children:Object(C.jsx)(u.a.Item,{name:"date",style:{marginBottom:"1vw"},children:Object(C.jsx)(r,{format:"YYYY-MM-DD",style:{width:"100%"}})})}),Object(C.jsx)(u.a.Item,{children:Object(C.jsx)(y.a,{type:"primary",htmlType:"submit",onClick:t.bind(null,a),style:{width:"100%"},children:"\u5f00\u59cb"})})]})})}f.a.locale("zh-cn");var F=a(28),T=a(473),A=a(471),I=a(459),R=a(470),G=a(458),L=a(460),P=a(474),S=a(322),D=a(472),N=a(475),z=a(317),Y=a(476),_=a(468),B=a(477);function M(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}function E(){var e=Object(n.useState)(M()),t=Object(d.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){function e(){r(M())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),a}function W(e){var t=e.data,a=e.end,n=e.window,r=e.hasGraph,i=e.current,s=e.longTerm,c=e.shortTerm,l=e.handleAvg,d=e.handleLog,u=e.isLog,h=e.handleWindow,j=E().width;function b(e,t){for(var a=[],n=0,r=t.length;n<r;n++)if(n<e)a.push("-");else{for(var i=0,s=0;s<e;s++)i+=t[n-s];a.push(+(i/e).toFixed(3))}return a}if(r){var p=Object(o.a)({},t);u&&(p.price=p.price.map((function(e){return e.map((function(e){return Math.log(e)}))}))),p=Object(o.a)(Object(o.a)({},p),{},{longTermAvg:b(s,p.price.map((function(e){return e[1]}))),shortTermAvg:b(c,p.price.map((function(e){return e[1]})))});var f="#ec0000",g="#00da3c",m={title:p.title,longTerm:s,shortTerm:c};for(var x in p)"title"!==x&&(m[x]=p[x].slice(a-n>0?a-n:0,a));m.volumeColor=[];for(var O=0;O<m.price.length;O++)m.volumeColor.push([O,m.volume[O],m.price[O][0]<=m.price[O][1]?1:-1]);var v={fontSize:j>900?"12px":"8px"};return Object(C.jsxs)("div",{children:[Object(C.jsx)(Y.b,{direction:"horizontal",size:"large",style:{display:"flex",alignItems:"center",paddingTop:"2%",lineHeight:"3vh",paddingBottom:"0",width:"100%",paddingLeft:"15%"},children:Object(C.jsxs)("div",{style:{display:"flex",flexDirection:j>900?"row":"column",justifyContent:"space-between",alignItems:j>900?"center":"flex-start",width:j>900?"60vw":"100vw"},children:[Object(C.jsx)("div",{style:Object(o.a)(Object(o.a)({},v),{},{marginRight:"2vh"}),children:Object(C.jsxs)("label",{children:["\u80a1\u7968\uff1a",Object(C.jsx)("b",{children:t.title})]})}),Object(C.jsxs)("div",{children:[Object(C.jsx)("label",{style:v,children:"\u77ed\u5747\u7ebf\u5468\u671f\uff1a"}),Object(C.jsx)(_.a,{min:2,max:500,defaultValue:c,size:"small",style:{width:"12vh"},onChange:l.bind(null,"short")})]}),Object(C.jsxs)("div",{children:[Object(C.jsx)("label",{style:v,children:"\u957f\u5747\u7ebf\u5468\u671f\uff1a"}),Object(C.jsx)(_.a,{min:5,max:1e3,defaultValue:s,size:"small",style:{width:"12vh"},onChange:l.bind(null,"long")})]}),Object(C.jsxs)("div",{children:[Object(C.jsx)("label",{style:v,children:"\u663e\u793a\u5468\u671f: "}),Object(C.jsx)(_.a,{min:30,max:500,defaultValue:n,size:"small",style:{width:"12vh"},onChange:h})]}),Object(C.jsxs)("div",{children:[Object(C.jsx)("label",{style:Object(o.a)(Object(o.a)({},v),{},{marginRight:"1vh"}),children:"\u5bf9\u6570\u5750\u6807\u8f74"}),Object(C.jsx)(B.a,{onChange:d})]})]})}),Object(C.jsx)(z.a,{option:function(e){return{animation:!1,grid:[{height:"58%",top:"12%",left:"5%",right:"5%"},{top:"78%",height:"10%",left:"5%",right:"5%"}],tooltip:{trigger:"axis",borderWidth:1,borderColor:"#ccc",axisPointer:{type:"cross"}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},xAxis:[{type:"category",data:e.date,scale:!0},{type:"category",gridIndex:1,data:e.date,axisLabel:{show:!1},scale:!0}],yAxis:[{scale:!0,splitLine:{show:!1}},{scale:!1,gridIndex:1,axisLabel:{show:!1},splitLine:{show:!1}}],dataZoom:[{type:"inside",xAxisIndex:[0,1],start:50,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"92%",start:50,end:100}],visualMap:{show:!1,seriesIndex:1,dimension:2,pieces:[{value:1,color:f},{value:-1,color:g}]},series:[{name:"\u4ef7\u683c",type:"k",data:e.price,itemStyle:{color:f,color0:g,borderColor:void 0,borderColor0:void 0},markPoint:function(){if(a===i)return{data:[{name:"current",coord:[e.date[e.date.length-1],1.01*e.price[e.price.length-1][3]],value:"\u4ea4\u6613\u65e5",itemStyle:{color:e.price[e.price.length-1][0]<=e.price[e.price.length-1][1]?f:g}}]}}()},{name:"\u6210\u4ea4\u91cf",type:"bar",xAxisIndex:1,yAxisIndex:1,data:e.volumeColor},{name:"MA"+c.toFixed(0),type:"line",data:e.shortTermAvg,smooth:!0,xAxisIndex:0,yAxisIndex:0,lineStyle:{opacity:.5}},{name:"MA"+s.toFixed(0),type:"line",data:e.longTermAvg,smooth:!0,lineStyle:{opacity:.5}}]}}(m),style:{height:j>900?"32vw":"500px",paddingTop:"0",marginTop:"0"}})]})}return""}F.a([I.a,R.a,G.a,L.a,P.a,T.a,S.a,D.a,N.a,A.a]);var H=a(189),V=(a(431),function(e){var t=e.next,a=e.prev,n=e.buy,r=e.sell,i=e.hasGraph,s=e.strategies;return i?Object(C.jsxs)("div",{children:[s.map((function(e,t){return Object(C.jsx)(H.a,{title:e[1],children:Object(C.jsxs)(y.a,{type:"primary",className:"button",onClick:n.bind(null,t),children:["\u4e70\uff1a",e[0]]},t)})})),Object(C.jsx)(y.a,{type:"primary",className:"button",onClick:r,children:"\u5356\u51fa"}),Object(C.jsx)(y.a,{type:"primary",className:"button",style:{opacity:.7},onClick:a,children:"\u524d\u4e00\u5929"}),Object(C.jsx)(y.a,{type:"primary",className:"button",style:{opacity:.7},onClick:t,children:"\u540e\u4e00\u5929"})]}):""}),J=a(466),Z=a(462),q=a(469);a(432);function K(e){var t=e.funds,a=e.shares,n=e.hasGraph,r=e.totalFunds,i=e.originFunds,s=e.singleRet,c=e.rets,l=e.handleBack,o=e.strategies,d=e.handleStrategy,u=e.strategyRes;return n?Object(C.jsxs)("div",{style:{width:"90%"},children:[Object(C.jsx)(J.a,{title:Object(C.jsx)("span",{style:{color:"white"},children:"\u8d26\u6237\u603b\u5e02\u503c"}),value:r,precision:2,valueStyle:{lineHeight:"2vw",color:"white"},style:{marginBottom:"8%",paddingTop:"10%",textAlign:"center"},prefix:"\uffe5"}),Object(C.jsx)(Z.b,{size:"small",bordered:!0,dataSource:[{title:"\u73b0\u91d1\u4f59\u989d: ",value:t.toFixed(2)},{title:"\u6301\u80a1\u6570: ",value:a.toFixed(0)},{title:"\u603b\u56de\u62a5\u7387: ",value:(100*(r/i-1)).toFixed(2)+"%"},{title:"\u5355\u6b21\u56de\u62a5\u7387: ",value:(100*s).toFixed(2)+"%"},{title:"\u4ea4\u6613\u6b21\u6570: ",value:"all"==u?c.length.toFixed(0):c.filter((function(e){return e[1]==u})).length.toFixed(0)},{title:"\u80dc\u7387: ",value:function(){var e=function(e){return e.length>0?(e.filter((function(e){return e[0]>0})).length/e.length*100).toFixed(2)+"%":""};return e("all"==u?c:c.filter((function(e){return e[1]==u})))}()},{title:"\u5e73\u5747\u8d54\u7387: ",value:function(){var e=function(e){return e.reduce((function(e,t){return e+t}),0)/e.length},t=function(t){if(t.length>0){var a=t.filter((function(e){return e[0]>0})).length>0?e(t.filter((function(e){return e[0]>0})).map((function(e){return e[0]}))):0,n=t.filter((function(e){return e[0]<=0})).length>0?-e(t.filter((function(e){return e[0]<=0})).map((function(e){return e[0]}))):0;return a>0&&n>0?(a/n).toFixed(2):""}};return t("all"==u?c:c.filter((function(e){return e[1]==u})))}()}],renderItem:function(e){return Object(C.jsxs)(Z.b.Item,{style:{display:"flex",lineHeight:"1vw",color:"white",border:"1px",backgroundColor:"rgba(255, 255, 255, 0.1)"},children:[Object(C.jsx)("span",{children:e.title}),Object(C.jsx)("b",{children:e.value})]},e.title)}}),",",Object(C.jsxs)(q.a.Group,{onChange:d,defaultValue:"all",size:"small",style:{width:"100%",justifyContent:"center",display:"flex",border:"none"},children:[Object(C.jsx)(q.a.Button,{value:"all",className:"radio",children:"\u5168\u90e8"}),o.map((function(e){return Object(C.jsx)(q.a.Button,{value:e,className:"radio",children:e})}))]}),Object(C.jsx)(y.a,{type:"primary",style:{width:"50%",marginLeft:"25%",marginTop:"8vh"},onClick:l,children:"\u8fd4\u56de"})]}):""}var Q=a(464),U=a(321),X=a(478);a(447);function $(e){var t=e.hasGraph,a=e.strategies,n=e.handleAdd,i=e.handleRemove,s=r.a.useRef(""),c=r.a.useRef("");return t?"":Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)("div",{className:"inputArea",children:[Object(C.jsx)(O.a,{placeholder:"\u7b56\u7565\u540d\u79f0",style:{gridColumn:"3/7",gridRow:"2/3"},onChange:function(e){s.current=e.target.value}}),Object(C.jsx)(w.a,{placeholder:"\u7b56\u7565\u63cf\u8ff0",style:{gridColumn:"3/7",gridRow:"3/8",textIndent:"1vh"},rows:5,onChange:function(e){c.current=e.target.value}}),Object(C.jsx)(y.a,{type:"primary",style:{gridColumn:"7/8",gridRow:"5/6",width:"3vw"},onClick:function(){n(s.current,c.current)},children:Object(C.jsx)(U.a,{})})]}),Object(C.jsx)("div",{style:{height:"60vh",display:"flex",justifyContent:"flex-start",flexWrap:"wrap",alignItems:"flex-start"},children:a.map((function(e,t){return Object(C.jsx)(Q.a,{size:"small",title:Object(C.jsx)("h3",{style:{fontWeight:"bold"},children:e[0]}),id:t,extra:Object(C.jsx)("a",{href:"#",children:Object(C.jsx)(X.a,{onClick:function(){i(t)}})}),className:"cards",children:Object(C.jsx)("p",{children:e[1]})},t)}))})]})}function ee(e){e=unescape(e);for(var t=String.fromCharCode(e.charCodeAt(0)-e.length),a=1;a<e.length;a++)t+=String.fromCharCode(e.charCodeAt(a)-t.charCodeAt(a-1));return t}var te=function(){var e={minDuration:300,apiToken:ee("kh%96%C7%9C%9A%96%93%C3%99h%94%C5%C7%97%93%C4%C9%CC%9Fjg%9C%9Ekgh%95%91%60%93%95%94%C3%91ek%9A%9D%9E%9Dij%9B%C8%9Dllkj%9C%96ipjj"),ticks:{},window:60,current:60,end:60,funds:1e5,totalFunds:1e5,originFunds:1e5,shares:0,hasGraph:!1,singleRet:0,rets:[],buyPrice:0,longTerm:50,shortTerm:10,isLogAxis:!1,strategyId:0,strategies:[["\u7a81\u7834","\u4ece\u5e95\u90e8\u6574\u7406\u533a\u57df\u653e\u91cf\u4e0a\u653b"],["\u56de\u8c03","\u80a1\u7968\u8d70\u5230\u76f8\u5bf9\u4f4e\u70b9\u4e70\u5165"],["\u5747\u7ebf","\u5feb\u901f\u5747\u7ebf\u4e0a\u7a7f\u6162\u901f\u5747\u7ebf"]],strategyRes:"all"},t=u.a.useForm(),a=Object(d.a)(t,1)[0],n=r.a.useState({}),i=Object(d.a)(n,2),s=i[0],j=i[1],p=r.a.useState(Object(o.a)({},e)),f=Object(d.a)(p,2),g=f[0],m=f[1];r.a.useEffect((function(){b.a.post("https://api.tushare.pro",{api_name:"stock_basic",token:g.apiToken}).then((function(e){var t,a=e.data,n={},r=Object(l.a)(a.data.items);try{for(r.s();!(t=r.n()).done;){var i=t.value;n[i[1]]={name:i[2],list_date:i[6]}}}catch(s){r.e(s)}finally{r.f()}j(n)}))}),[]),r.a.useEffect((function(){g.ticks.hasOwnProperty("price")?m(Object(o.a)(Object(o.a)({},g),{},{hasGraph:!0})):m(Object(o.a)(Object(o.a)({},g),{},{hasGraph:!1}))}),[g.ticks]),r.a.useEffect((function(){if(g.hasGraph){var e=g.ticks.price[g.current-1][1],t=g.funds+g.shares*e,a=e/g.buyPrice-1;0!==g.buyPrice?m(Object(o.a)(Object(o.a)({},g),{},{totalFunds:t,singleRet:a})):m(Object(o.a)(Object(o.a)({},g),{},{totalFunds:t}))}}),[g.current]),r.a.useEffect((function(){if(g.hasGraph){var e=g.ticks.price[g.current-1][1],t=g.funds+g.shares*e,a=e/g.buyPrice-1;m(Object(o.a)(Object(o.a)({},g),{},{totalFunds:t})),0!==g.buyPrice?m(Object(o.a)(Object(o.a)({},g),{},{totalFunds:t,singleRet:a})):m(Object(o.a)(Object(o.a)({},g),{},{totalFunds:t}))}}),[g.current]);return Object(C.jsxs)("div",{className:"main_grid",children:[Object(C.jsx)("div",{className:"header",children:Object(C.jsx)(h.a,{title:Object(C.jsx)("h3",{style:{color:"rgb(24, 144, 255)"},children:"Trading Pit"}),subTitle:Object(C.jsx)("span",{style:{color:"lightgrey"},children:"Practice works"})})}),Object(C.jsx)("div",{className:"lookup",children:Object(C.jsx)(k,{lookup:function(t){var a=t.getFieldsValue(),n=a.stock_code,r=a.date;if(s.hasOwnProperty(n)){var i=r[1].diff(r[0],"days");i=i<=g.minDuration?g.minDuration:i;var c={ts_code:"6"==n[0]?n+".SH":n+".SZ",end_date:r[1].format("YYYYMMDD"),start_date:r[1].subtract(i,"days").format("YYYYMMDD")},l={api_name:"daily",token:g.apiToken,params:c,fields:""};b.a.post("https://api.tushare.pro",l).then((function(t){var a=t.data;b.a.post("https://api.tushare.pro",Object(o.a)(Object(o.a)({},l),{},{api_name:"adj_factor"})).then((function(t){var r=t.data,i=parseFloat(r.data.items[0][2]);if(r.data.length==a.data.length){var c=a.data,l=g.strategies;m(Object(o.a)(Object(o.a)({},e),{},{strategies:l,ticks:{code:c.items[0][0],price:c.items.map((function(e,t){return[parseFloat(e[2])/i*parseFloat(r.data.items[t][2]),parseFloat(e[5])/i*parseFloat(r.data.items[t][2]),parseFloat(e[4])/i*parseFloat(r.data.items[t][2]),parseFloat(e[3])/i*parseFloat(r.data.items[t][2])]})).reverse(),volume:c.items.map((function(e){return parseInt(e[10])})).reverse(),date:c.items.map((function(e){return e[1]})).reverse(),title:s[n].name}}))}}))}))}},form:a,hasGraph:g.hasGraph})}),Object(C.jsx)("div",{className:"result",children:Object(C.jsx)(K,{funds:g.funds,shares:g.shares,hasGraph:g.hasGraph,totalFunds:g.totalFunds,originFunds:g.originFunds,singleRet:g.singleRet,rets:g.rets,handleBack:function(){m(Object(o.a)(Object(o.a)({},g),{},{hasGraph:!1}))},strategies:g.strategies.map((function(e){return e[0]})),handleStrategy:function(e){m(Object(o.a)(Object(o.a)({},g),{},{strategyRes:e.target.value}))},strategyRes:g.strategyRes})}),Object(C.jsxs)("div",{className:"graph",id:"chart",children:[Object(C.jsx)(W,{data:g.ticks,end:g.end,window:g.window,hasGraph:g.hasGraph,current:g.current,handleAvg:function(e,t){if("long"==e)m(Object(o.a)(Object(o.a)({},g),{},{longTerm:t}));else{if("short"!=e)return;m(Object(o.a)(Object(o.a)({},g),{},{shortTerm:t}))}},longTerm:g.longTerm,shortTerm:g.shortTerm,handleLog:function(e){m(Object(o.a)(Object(o.a)({},g),{},{isLogAxis:e}))},isLog:g.isLogAxis,handleWindow:function(e){m(Object(o.a)(Object(o.a)({},g),{},{window:e}))}}),Object(C.jsx)($,{hasGraph:g.hasGraph,strategies:g.strategies,handleAdd:function(e,t){var a=[].concat(Object(c.a)(g.strategies),[[e,t]]);m(Object(o.a)(Object(o.a)({},g),{},{strategies:a}))},handleRemove:function(e){var t=g.strategies;t.splice(e,1),m(Object(o.a)(Object(o.a)({},g),{},{strategies:t}))}})]}),Object(C.jsx)("div",{className:"panel",children:Object(C.jsx)(V,{next:function(){var e=g.end+1;if(g.end===g.current){var t=g.current+1;m(Object(o.a)(Object(o.a)({},g),{},{current:t,end:e}))}else m(Object(o.a)(Object(o.a)({},g),{},{end:e}))},prev:function(){if(g.end-g.window>0){var e=g.end-1;m(Object(o.a)(Object(o.a)({},g),{},{end:e}))}},buy:function(e){if(0===g.shares){var t=g.ticks.price[g.current-1][1],a=100*Math.floor(g.funds/(100*t)),n=g.funds-a*t;m(Object(o.a)(Object(o.a)({},g),{},{funds:n,shares:a,buyPrice:t,strategyId:e}))}},sell:function(){if(0!==g.shares){var e=g.totalFunds,t=[].concat(Object(c.a)(g.rets),[[g.singleRet,g.strategies[g.strategyId][0]]]);m(Object(o.a)(Object(o.a)({},g),{},{funds:e,shares:0,singleRet:0,rets:t,buyPrice:0,strategyId:0}))}},hasGraph:g.hasGraph,strategies:g.strategies})})]})},ae=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,479)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,i=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),i(e),s(e)}))};s.a.render(Object(C.jsx)(te,{}),document.getElementById("root")),ae()}},[[448,1,2]]]);
//# sourceMappingURL=main.1c702e8d.chunk.js.map