(this["webpackJsonptrading-pit"]=this["webpackJsonptrading-pit"]||[]).push([[0],{329:function(e,t,a){},330:function(e,t,a){},331:function(e,t,a){},431:function(e,t,a){},432:function(e,t,a){},447:function(e,t,a){},448:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(87),s=a.n(i),c=(a(329),a(274)),l=a(307),o=a(45),d=a(260),u=(a(330),a(331),a(465)),h=a(463),j=a(259),b=a.n(j),p=a(123),f=a.n(p),g=a(312),m=a.n(g),x=(a(350),a(351),a(461)),O=a(467),v=a(39),y=a(163),w=(a(94),a(204)),F=a(17);function k(e){var t=e.lookup,a=e.form,n=e.hasGraph,r=x.a.RangePicker;return n?"":Object(F.jsx)("div",{style:{width:"90%",marginTop:"10%"},children:Object(F.jsxs)(u.a,{name:"lookup",autoComplete:"off",form:a,children:[Object(F.jsx)(u.a.Item,{id:"code",name:"stock_code",rules:[{required:!0}],style:{marginBottom:"1vw"},children:Object(F.jsx)(O.a,{placeholder:"\u80a1\u7968\u4ee3\u7801"})}),Object(F.jsx)(v.a,{locale:m.a,children:Object(F.jsx)(u.a.Item,{name:"date",style:{marginBottom:"1vw"},children:Object(F.jsx)(r,{format:"YYYY-MM-DD",style:{width:"100%"}})})}),Object(F.jsx)(u.a.Item,{children:Object(F.jsx)(y.a,{type:"primary",htmlType:"submit",onClick:t.bind(null,a),style:{width:"100%"},children:"\u5f00\u59cb"})})]})})}f.a.locale("zh-cn");var C=a(28),T=a(473),I=a(471),A=a(459),R=a(470),G=a(458),P=a(460),L=a(474),N=a(322),S=a(472),Y=a(475),_=a(317),M=a(476),z=a(468),B=a(477);function D(e){var t=e.data,a=e.end,n=e.window,r=e.hasGraph,i=e.current,s=e.longTerm,c=e.shortTerm,l=e.handleAvg,d=e.handleLog,u=e.isLog,h=e.handleWindow;function j(e,t){for(var a=[],n=0,r=t.length;n<r;n++)if(n<e)a.push("-");else{for(var i=0,s=0;s<e;s++)i+=t[n-s];a.push(+(i/e).toFixed(3))}return a}if(r){var b=Object(o.a)({},t);u&&(b.price=b.price.map((function(e){return e.map((function(e){return Math.log(e)}))}))),b=Object(o.a)(Object(o.a)({},b),{},{longTermAvg:j(s,b.price.map((function(e){return e[1]}))),shortTermAvg:j(c,b.price.map((function(e){return e[1]})))});var p="#ec0000",f="#00da3c",g={title:b.title,longTerm:s,shortTerm:c};for(var m in b)"title"!==m&&(g[m]=b[m].slice(a-n>0?a-n:0,a));g.volumeColor=[];for(var x=0;x<g.price.length;x++)g.volumeColor.push([x,g.volume[x],g.price[x][0]<=g.price[x][1]?1:-1]);var O={fontSize:"12px"};return Object(F.jsxs)("div",{children:[Object(F.jsxs)(M.b,{direction:"horizontal",size:"large",style:{display:"flex",alignItems:"center",paddingTop:"2%",lineHeight:"3vh",paddingBottom:"0",width:"100%",paddingLeft:"15%"},children:[Object(F.jsx)("div",{style:Object(o.a)(Object(o.a)({},O),{},{marginRight:"2vh"}),children:Object(F.jsxs)("label",{children:["\u80a1\u7968\uff1a",Object(F.jsx)("b",{children:t.title})]})}),Object(F.jsxs)("div",{children:[Object(F.jsx)("label",{style:O,children:"\u77ed\u5747\u7ebf\u5468\u671f\uff1a"}),Object(F.jsx)(z.a,{min:2,max:500,defaultValue:c,size:"small",style:{width:"12vh"},onChange:l.bind(null,"short")})]}),Object(F.jsxs)("div",{children:[Object(F.jsx)("label",{style:O,children:"\u957f\u5747\u7ebf\u5468\u671f\uff1a"}),Object(F.jsx)(z.a,{min:5,max:1e3,defaultValue:s,size:"small",style:{width:"12vh"},onChange:l.bind(null,"long")})]}),Object(F.jsxs)("div",{children:[Object(F.jsx)("label",{style:O,children:"\u663e\u793a\u5468\u671f: "}),Object(F.jsx)(z.a,{min:30,max:500,defaultValue:n,size:"small",style:{width:"12vh"},onChange:h})]}),Object(F.jsxs)("div",{children:[Object(F.jsx)("label",{style:Object(o.a)(Object(o.a)({},O),{},{marginRight:"1vh"}),children:"\u5bf9\u6570\u5750\u6807\u8f74"}),Object(F.jsx)(B.a,{onChange:d})]})]}),Object(F.jsx)(_.a,{option:function(e){return{animation:!1,grid:[{height:"58%",top:"12%",left:"5%",right:"5%"},{top:"78%",height:"10%",left:"5%",right:"5%"}],tooltip:{trigger:"axis",borderWidth:1,borderColor:"#ccc",axisPointer:{type:"cross"}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},xAxis:[{type:"category",data:e.date,scale:!0},{type:"category",gridIndex:1,data:e.date,axisLabel:{show:!1},scale:!0}],yAxis:[{scale:!0,splitLine:{show:!1}},{scale:!1,gridIndex:1,axisLabel:{show:!1},splitLine:{show:!1}}],dataZoom:[{type:"inside",xAxisIndex:[0,1],start:50,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"92%",start:50,end:100}],visualMap:{show:!1,seriesIndex:1,dimension:2,pieces:[{value:1,color:p},{value:-1,color:f}]},series:[{name:"\u4ef7\u683c",type:"k",data:e.price,itemStyle:{color:p,color0:f,borderColor:void 0,borderColor0:void 0},markPoint:function(){if(a===i)return{data:[{name:"current",coord:[e.date[e.date.length-1],1.01*e.price[e.price.length-1][3]],value:"\u4ea4\u6613\u65e5",itemStyle:{color:e.price[e.price.length-1][0]<=e.price[e.price.length-1][1]?p:f}}]}}()},{name:"\u6210\u4ea4\u91cf",type:"bar",xAxisIndex:1,yAxisIndex:1,data:e.volumeColor},{name:"MA"+c.toFixed(0),type:"line",data:e.shortTermAvg,smooth:!0,xAxisIndex:0,yAxisIndex:0,lineStyle:{opacity:.5}},{name:"MA"+s.toFixed(0),type:"line",data:e.longTermAvg,smooth:!0,lineStyle:{opacity:.5}}]}}(g),style:{height:"32vw",paddingTop:"0",marginTop:"0"}})]})}return""}C.a([A.a,R.a,G.a,P.a,L.a,T.a,N.a,S.a,Y.a,I.a]);var E=a(189),V=(a(431),function(e){var t=e.next,a=e.prev,n=e.buy,r=e.sell,i=e.hasGraph,s=e.strategies;return i?Object(F.jsxs)("div",{children:[s.map((function(e,t){return Object(F.jsx)(E.a,{title:e[1],children:Object(F.jsxs)(y.a,{type:"primary",className:"button",onClick:n.bind(null,t),children:["\u4e70\uff1a",e[0]]},t)})})),Object(F.jsx)(y.a,{type:"primary",className:"button",onClick:r,children:"\u5356\u51fa"}),Object(F.jsx)(y.a,{type:"primary",className:"button",style:{marginLeft:"3vw"},onClick:a,children:"\u524d\u4e00\u5929"}),Object(F.jsx)(y.a,{type:"primary",className:"button",style:{marginRight:"0"},onClick:t,children:"\u540e\u4e00\u5929"})]}):""}),W=a(466),H=a(462),J=a(469);a(432);function Z(e){var t=e.funds,a=e.shares,n=e.hasGraph,r=e.totalFunds,i=e.originFunds,s=e.singleRet,c=e.rets,l=e.handleBack,o=e.strategies,d=e.handleStrategy,u=e.strategyRes;return n?Object(F.jsxs)("div",{style:{width:"90%"},children:[Object(F.jsx)(W.a,{title:Object(F.jsx)("span",{style:{color:"white"},children:"\u8d26\u6237\u603b\u5e02\u503c"}),value:r,precision:2,valueStyle:{lineHeight:"2vw",color:"white"},style:{marginBottom:"8%",paddingTop:"10%",textAlign:"center"},prefix:"\uffe5"}),Object(F.jsx)(H.b,{size:"small",bordered:!0,dataSource:[{title:"\u73b0\u91d1\u4f59\u989d: ",value:t.toFixed(2)},{title:"\u6301\u80a1\u6570: ",value:a.toFixed(0)},{title:"\u603b\u56de\u62a5\u7387: ",value:(100*(r/i-1)).toFixed(2)+"%"},{title:"\u5355\u6b21\u56de\u62a5\u7387: ",value:(100*s).toFixed(2)+"%"},{title:"\u4ea4\u6613\u6b21\u6570: ",value:"all"==u?c.length.toFixed(0):c.filter((function(e){return e[1]==u})).length.toFixed(0)},{title:"\u80dc\u7387: ",value:function(){var e=function(e){return e.length>0?(e.filter((function(e){return e[0]>0})).length/e.length*100).toFixed(2)+"%":""};return e("all"==u?c:c.filter((function(e){return e[1]==u})))}()},{title:"\u5e73\u5747\u8d54\u7387: ",value:function(){var e=function(e){return e.reduce((function(e,t){return e+t}),0)/e.length},t=function(t){if(t.length>0){var a=t.filter((function(e){return e[0]>0})).length>0?e(t.filter((function(e){return e[0]>0})).map((function(e){return e[0]}))):0,n=t.filter((function(e){return e[0]<=0})).length>0?-e(t.filter((function(e){return e[0]<=0})).map((function(e){return e[0]}))):0;return a>0&&n>0?(a/n).toFixed(2):""}};return t("all"==u?c:c.filter((function(e){return e[1]==u})))}()}],renderItem:function(e){return Object(F.jsxs)(H.b.Item,{style:{display:"flex",lineHeight:"1vw",color:"white",border:"1px",backgroundColor:"rgba(255, 255, 255, 0.1)"},children:[Object(F.jsx)("span",{children:e.title}),Object(F.jsx)("b",{children:e.value})]},e.title)}}),",",Object(F.jsxs)(J.a.Group,{onChange:d,defaultValue:"all",size:"small",style:{width:"100%",justifyContent:"center",display:"flex",border:"none"},children:[Object(F.jsx)(J.a.Button,{value:"all",className:"radio",children:"\u5168\u90e8"}),o.map((function(e){return Object(F.jsx)(J.a.Button,{value:e,className:"radio",children:e})}))]}),Object(F.jsx)(y.a,{type:"primary",style:{width:"50%",marginLeft:"25%",marginTop:"8vh"},onClick:l,children:"\u8fd4\u56de"})]}):""}var q=a(464),K=a(321),Q=a(478);a(447);function U(e){var t=e.hasGraph,a=e.strategies,n=e.handleAdd,i=e.handleRemove,s=r.a.useRef(""),c=r.a.useRef("");return t?"":Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)("div",{className:"inputArea",children:[Object(F.jsx)(O.a,{placeholder:"\u7b56\u7565\u540d\u79f0",style:{gridColumn:"3/7",gridRow:"2/3"},onChange:function(e){s.current=e.target.value}}),Object(F.jsx)(w.a,{placeholder:"\u7b56\u7565\u63cf\u8ff0",style:{gridColumn:"3/7",gridRow:"3/8",textIndent:"1vh"},rows:5,onChange:function(e){c.current=e.target.value}}),Object(F.jsx)(y.a,{type:"primary",style:{gridColumn:"7/8",gridRow:"5/6",width:"3vw"},onClick:function(){n(s.current,c.current)},children:Object(F.jsx)(K.a,{})})]}),Object(F.jsx)("div",{style:{height:"60vh",display:"flex",justifyContent:"flex-start",flexWrap:"wrap",alignItems:"flex-start"},children:a.map((function(e,t){return Object(F.jsx)(q.a,{size:"small",title:Object(F.jsx)("h3",{style:{fontWeight:"bold"},children:e[0]}),id:t,extra:Object(F.jsx)("a",{href:"#",children:Object(F.jsx)(Q.a,{onClick:function(){i(t)}})}),className:"cards",children:Object(F.jsx)("p",{children:e[1]})},t)}))})]})}var X=function(){var e={minDuration:300,apiToken:"35af6d2ab71cbe2acff916f8344a00c2ba056d9e819bf75746f09737",ticks:{},window:60,current:60,end:60,funds:1e5,totalFunds:1e5,originFunds:1e5,shares:0,hasGraph:!1,singleRet:0,rets:[],buyPrice:0,longTerm:50,shortTerm:10,isLogAxis:!1,strategyId:0,strategies:[["\u7a81\u7834","\u4ece\u5e95\u90e8\u6574\u7406\u533a\u57df\u653e\u91cf\u4e0a\u653b"],["\u56de\u8c03","\u80a1\u7968\u8d70\u5230\u76f8\u5bf9\u4f4e\u70b9\u4e70\u5165"],["\u5747\u7ebf","\u5feb\u901f\u5747\u7ebf\u4e0a\u7a7f\u6162\u901f\u5747\u7ebf"]],strategyRes:"all"},t=u.a.useForm(),a=Object(d.a)(t,1)[0],n=r.a.useState({}),i=Object(d.a)(n,2),s=i[0],j=i[1],p=r.a.useState(Object(o.a)({},e)),f=Object(d.a)(p,2),g=f[0],m=f[1];r.a.useEffect((function(){b.a.post("https://api.tushare.pro",{api_name:"stock_basic",token:g.apiToken}).then((function(e){var t,a=e.data,n={},r=Object(l.a)(a.data.items);try{for(r.s();!(t=r.n()).done;){var i=t.value;n[i[1]]={name:i[2],list_date:i[6]}}}catch(s){r.e(s)}finally{r.f()}j(n)}))}),[]),r.a.useEffect((function(){g.ticks.hasOwnProperty("price")?m(Object(o.a)(Object(o.a)({},g),{},{hasGraph:!0})):m(Object(o.a)(Object(o.a)({},g),{},{hasGraph:!1}))}),[g.ticks]),r.a.useEffect((function(){if(g.hasGraph){var e=g.ticks.price[g.current-1][1],t=g.funds+g.shares*e,a=e/g.buyPrice-1;0!==g.buyPrice?m(Object(o.a)(Object(o.a)({},g),{},{totalFunds:t,singleRet:a})):m(Object(o.a)(Object(o.a)({},g),{},{totalFunds:t}))}}),[g.current]),r.a.useEffect((function(){if(g.hasGraph){var e=g.ticks.price[g.current-1][1],t=g.funds+g.shares*e,a=e/g.buyPrice-1;m(Object(o.a)(Object(o.a)({},g),{},{totalFunds:t})),0!==g.buyPrice?m(Object(o.a)(Object(o.a)({},g),{},{totalFunds:t,singleRet:a})):m(Object(o.a)(Object(o.a)({},g),{},{totalFunds:t}))}}),[g.current]);return Object(F.jsxs)("div",{className:"main_grid",children:[Object(F.jsx)("div",{className:"header",children:Object(F.jsx)(h.a,{title:Object(F.jsx)("h3",{style:{color:"rgb(24, 144, 255)"},children:"Trading Pit"}),subTitle:Object(F.jsx)("span",{style:{color:"lightgrey"},children:"Practice works"})})}),Object(F.jsx)("div",{className:"lookup",children:Object(F.jsx)(k,{lookup:function(t){var a=t.getFieldsValue(),n=a.stock_code,r=a.date;if(s.hasOwnProperty(n)){var i=r[1].diff(r[0],"days");i=i<=g.minDuration?g.minDuration:i;var c={ts_code:"6"==n[0]?n+".SH":n+".SZ",end_date:r[1].format("YYYYMMDD"),start_date:r[1].subtract(i,"days").format("YYYYMMDD")},l={api_name:"daily",token:g.apiToken,params:c,fields:""};b.a.post("https://api.tushare.pro",l).then((function(t){var a=t.data;b.a.post("https://api.tushare.pro",Object(o.a)(Object(o.a)({},l),{},{api_name:"adj_factor"})).then((function(t){var r=t.data,i=parseFloat(r.data.items[0][2]);if(r.data.length==a.data.length){var c=a.data,l=g.strategies;m(Object(o.a)(Object(o.a)({},e),{},{strategies:l,ticks:{code:c.items[0][0],price:c.items.map((function(e,t){return[parseFloat(e[2])/i*parseFloat(r.data.items[t][2]),parseFloat(e[5])/i*parseFloat(r.data.items[t][2]),parseFloat(e[4])/i*parseFloat(r.data.items[t][2]),parseFloat(e[3])/i*parseFloat(r.data.items[t][2])]})).reverse(),volume:c.items.map((function(e){return parseInt(e[10])})).reverse(),date:c.items.map((function(e){return e[1]})).reverse(),title:s[n].name}}))}}))}))}},form:a,hasGraph:g.hasGraph})}),Object(F.jsx)("div",{className:"result",children:Object(F.jsx)(Z,{funds:g.funds,shares:g.shares,hasGraph:g.hasGraph,totalFunds:g.totalFunds,originFunds:g.originFunds,singleRet:g.singleRet,rets:g.rets,handleBack:function(){m(Object(o.a)(Object(o.a)({},g),{},{hasGraph:!1}))},strategies:g.strategies.map((function(e){return e[0]})),handleStrategy:function(e){m(Object(o.a)(Object(o.a)({},g),{},{strategyRes:e.target.value}))},strategyRes:g.strategyRes})}),Object(F.jsxs)("div",{className:"graph",id:"chart",children:[Object(F.jsx)(D,{data:g.ticks,end:g.end,window:g.window,hasGraph:g.hasGraph,current:g.current,handleAvg:function(e,t){if("long"==e)m(Object(o.a)(Object(o.a)({},g),{},{longTerm:t}));else{if("short"!=e)return;m(Object(o.a)(Object(o.a)({},g),{},{shortTerm:t}))}},longTerm:g.longTerm,shortTerm:g.shortTerm,handleLog:function(e){m(Object(o.a)(Object(o.a)({},g),{},{isLogAxis:e}))},isLog:g.isLogAxis,handleWindow:function(e){m(Object(o.a)(Object(o.a)({},g),{},{window:e}))}}),Object(F.jsx)(U,{hasGraph:g.hasGraph,strategies:g.strategies,handleAdd:function(e,t){var a=[].concat(Object(c.a)(g.strategies),[[e,t]]);m(Object(o.a)(Object(o.a)({},g),{},{strategies:a}))},handleRemove:function(e){var t=g.strategies;t.splice(e,1),m(Object(o.a)(Object(o.a)({},g),{},{strategies:t}))}})]}),Object(F.jsx)("div",{className:"panel",children:Object(F.jsx)(V,{next:function(){var e=g.end+1;if(g.end===g.current){var t=g.current+1;m(Object(o.a)(Object(o.a)({},g),{},{current:t,end:e}))}else m(Object(o.a)(Object(o.a)({},g),{},{end:e}))},prev:function(){if(g.end-g.window>0){var e=g.end-1;m(Object(o.a)(Object(o.a)({},g),{},{end:e}))}},buy:function(e){if(0===g.shares){var t=g.ticks.price[g.current-1][1],a=100*Math.floor(g.funds/(100*t)),n=g.funds-a*t;m(Object(o.a)(Object(o.a)({},g),{},{funds:n,shares:a,buyPrice:t,strategyId:e}))}},sell:function(){if(0!==g.shares){var e=g.totalFunds,t=[].concat(Object(c.a)(g.rets),[[g.singleRet,g.strategies[g.strategyId][0]]]);m(Object(o.a)(Object(o.a)({},g),{},{funds:e,shares:0,singleRet:0,rets:t,buyPrice:0,strategyId:0}))}},hasGraph:g.hasGraph,strategies:g.strategies})})]})},$=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,479)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,i=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),i(e),s(e)}))};s.a.render(Object(F.jsx)(X,{}),document.getElementById("root")),$()}},[[448,1,2]]]);
//# sourceMappingURL=main.6e7be42f.chunk.js.map